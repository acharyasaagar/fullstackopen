(this.webpackJsonppart1=this.webpackJsonppart1||[]).push([[0],{19:function(e,t,a){e.exports=a(43)},24:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(17),c=a.n(l),o=(a(24),a(1)),u=a.n(o),s=a(18),i=a(4),m=a(2),b=r.a.forwardRef((function(e,t){var a=e.actionButtonLabel,l=e.cancelButtonLabel,c=e.children,o=Object(n.useState)(!1),u=Object(m.a)(o,2),s=u[0],i=u[1],b={display:s?"":"none"},g={display:s?"none":""},p=function(){return i(!s)};return Object(n.useImperativeHandle)(t,(function(){return{toggleVisibility:p,visible:s}})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:b,"data-test":"togglable-content"},c,l?r.a.createElement("button",{onClick:p},l):""),r.a.createElement("div",{style:g},a?r.a.createElement("button",{"data-test":"toggle-content-action-show",onClick:p},a):""))}));b.displayName="Toggleable";var g=b,p=function(e){var t=e.blog,a=e.deleteBlog,l=e.likeBlog,c=e.user,o=Object(n.useState)(!1),s=Object(m.a)(o,2),b=s[0],p=s[1],f=Object(n.useRef)(),d=function(){p(!b),f.current.toggleVisibility()};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"panel blog",id:"".concat(t.id)},r.a.createElement("div",{className:" ".concat(b?"d-none":"flex"),"data-test":"blog-preview"},r.a.createElement("h3",{className:"title","data-test":"blog-preview-title"},t.title),r.a.createElement("button",{onClick:d,"data-test":"view-blog-button",id:"view-blog-".concat(t.id)},"view blog",r.a.createElement("span",{role:"img","aria-label":"blog link"},"\xa0\ud83d\udd3b"))),r.a.createElement(g,{ref:f},r.a.createElement("section",{className:"flex"},r.a.createElement("div",null,r.a.createElement("p",{className:"title"},t.title),r.a.createElement("p",{className:"url"},r.a.createElement("span",{role:"img","aria-label":"blog link"},"\ud83d\udd17\xa0"),r.a.createElement("a",{href:t.url},t.url)),r.a.createElement("p",{className:"subtitle"},r.a.createElement("span",null," ",t.author," "),r.a.createElement("button",{className:"meta","data-test":"like-blog-button",onClick:function(e){return function(){var t=Object(i.a)(u.a.mark((function t(a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.target.blur(),t.next=3,l(e.id);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)},r.a.createElement("span",{role:"img","aria-label":"blog link"},"\xa0\xa0\ud83d\udda4\xa0\xa0"),t.likes?t.likes:0," likes"))),r.a.createElement("div",{className:"v-flex"},r.a.createElement("button",{onClick:d,"data-test":"hide-blog-button"},"hide blog",r.a.createElement("span",{role:"img","aria-label":"blog link"},"\xa0\ud83d\udd3a")),t.user&&c.id===t.user.id?r.a.createElement("button",{"data-test":"delete-blog-button",onClick:function(e){return Object(i.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Remove blog: ".concat(e.title))){t.next=4;break}return t.next=4,a(e.id);case 4:case"end":return t.stop()}}),t)})))}(t)},"delete",r.a.createElement("span",{role:"img","aria-label":"blog delete"},"\xa0\xa0\xa0\ud83d\uddd1")):"")))))},f=function(e){var t=e.err,a=e.success;return r.a.createElement("div",{className:"".concat(t?"error":""," ").concat(a?"success":"")},r.a.createElement("p",null,t?t.message:""),r.a.createElement("p",null,a?a.message:""))},d=function(e){var t=e.createBlog,a=e.setSuccess,l=Object(n.useState)(""),c=Object(m.a)(l,2),o=c[0],s=c[1],b=Object(n.useState)(""),g=Object(m.a)(b,2),p=g[0],d=g[1],E=Object(n.useState)(""),v=Object(m.a)(E,2),h=v[0],j=v[1],w=Object(n.useState)(null),O=Object(m.a)(w,2),k=O[0],x=O[1],y=function(){var e=Object(i.a)(u.a.mark((function e(n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r={author:h,title:o,url:p},e.prev=2,e.next=5,t(r);case 5:s(""),d(""),j(""),a({message:"New Blog Created"}),setTimeout((function(){return a(null)}),5e3),e.next=20;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0.message),s(""),d(""),j(""),x({message:e.t0.message}),setTimeout((function(){return x(null)}),5e3);case 20:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(f,{err:k}),r.a.createElement("h4",null,"Create Blog",r.a.createElement("span",{role:"img","aria-label":"user emoji"},"\xa0\xa0\ud83d\udcdd")),r.a.createElement("form",{onSubmit:y,"data-test":"create-blog-form"},r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"title"},"Blog Title:"),r.a.createElement("input",{"data-test":"blog-title-input",type:"text",name:"title",value:o,onChange:function(e){s(e.target.value)}})),r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"url"},"Blog URL: "),r.a.createElement("input",{"data-test":"blog-url-input",value:p,type:"text",name:"url",onChange:function(e){d(e.target.value)}})),r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"author"},"Author: "),r.a.createElement("input",{"data-test":"blog-author-input",value:h,type:"text",name:"author",onChange:function(e){j(e.target.value)}})),r.a.createElement("button",{type:"submit","data-test":"blog-add-button"},"add blog",r.a.createElement("span",{role:"img","aria-label":"user emoji"},"\xa0\xa0\u2795"))))},E=a(5),v=a.n(E),h={login:function(e){return v.a.post("/api/login",e)}},j=function(e){var t=e.setUser,a=Object(n.useState)(""),l=Object(m.a)(a,2),c=l[0],o=l[1],s=Object(n.useState)(""),b=Object(m.a)(s,2),g=b[0],p=b[1],d=Object(n.useState)(null),E=Object(m.a)(d,2),v=E[0],j=E[1],w=function(){var e=Object(i.a)(u.a.mark((function e(a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,h.login({username:c,password:g});case 4:n=e.sent,r=Object.assign({},n.data),window.localStorage.setItem("loggedUser",JSON.stringify(r)),t(r),h.setToken(r.token),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),j({message:"Invalid Credentials"}),setTimeout((function(){return j(null)}),5e3);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"panel"},r.a.createElement(f,{err:v,success:null}),r.a.createElement("h4",null,"Login to application"),r.a.createElement("form",{onSubmit:w},r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"username"},"Username: "),r.a.createElement("input",{type:"text",name:"username","data-test":"login-username-input",value:c,onChange:function(e){o(e.target.value)}})),r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"password"},"Password: "),r.a.createElement("input",{type:"password",name:"password","data-test":"login-password-input",value:g,onChange:function(e){p(e.target.value)}})),r.a.createElement("button",{type:"submit","data-test":"login-button"},"Log in")))},w=function(e){var t=e.user,a=e.handleLogout;return r.a.createElement("div",{className:"flex panel"},r.a.createElement("p",{className:"subtitle"},r.a.createElement("span",{role:"img","aria-label":"user emoji"},"\ud83d\udc64\xa0\xa0"),"Logged in as: ",r.a.createElement("span",{className:"title"}," ",t.username)),r.a.createElement("button",{id:"logout-button",onClick:a},"logout"))},O=function(){return"bearer ".concat(JSON.parse(window.localStorage.loggedUser).token)},k=function(){return{headers:{Authorization:O()}}},x=function(e){return v.a.post("/api/blogs",e,k())},y=function(){return v.a.get("/api/blogs")},S=function(e){return v.a.patch("".concat("/api/blogs","/").concat(e),{likes:"like"})},N=function(e){return v.a.delete("".concat("/api/blogs","/").concat(e),k())},B=function(){var e=Object(n.useState)([]),t=Object(m.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(null),o=Object(m.a)(c,2),b=o[0],E=o[1],v=Object(n.useState)(null),h=Object(m.a)(v,2),O=h[0],k=h[1],B=Object(n.useState)(null),C=Object(m.a)(B,2),L=C[0],F=C[1],T=a.sort((function(e,t){return t.likes-e.likes})),U=function(){var e=Object(i.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x(t);case 3:n=e.sent,r=n.data,l(a.concat(r)),R.current.toggleVisibility(),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Error creating blog");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(i.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S(t);case 3:n=e.sent,r=n.data,l(a.filter((function(e){return e.id!==t})).concat(r)),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),k({message:"Error liking blog"}),setTimeout((function(){return k(null)}),5e3);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N(t);case 3:l(a.filter((function(e){return e.id!==t}))),e.next=11;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0),k({message:"Error deleting blog"}),setTimeout((function(){return k(null)}),5e3);case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){function e(){return(e=Object(i.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:t=e.sent,l(Object(s.a)(t.data));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(n.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");E(JSON.parse(e))}),[]);var R=Object(n.useRef)(),V=function(){window.localStorage.removeItem("loggedUser"),E(null)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{err:O,success:L}),null===b?r.a.createElement(g,{actionButtonLabel:"log in",cancelButtonLabel:"cancel"},r.a.createElement(j,{setUser:E})):function(e){return r.a.createElement(w,{user:e,handleLogout:V})}(b),r.a.createElement("br",null),r.a.createElement("br",null),null===b?"":r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,r.a.createElement("span",{role:"img","aria-label":"blog emoji"},"\ud83d\udccb\xa0\xa0"),"Blogs"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"panel"},r.a.createElement(g,{actionButtonLabel:"Create a new blog",cancelButtonLabel:"close \xa0\xa0\u2716\ufe0f",ref:R},r.a.createElement(d,{createBlog:U,setSuccess:F}))),r.a.createElement("div",{id:"blogs"},T.map((function(e){return r.a.createElement(p,{blog:e,likeBlog:I,deleteBlog:J,key:e.id,user:b})})))))};c.a.render(r.a.createElement(B,null),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.2d0fdd61.chunk.js.map